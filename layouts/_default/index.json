{{- $.Scratch.Add "index" slice -}}
{{- range (where .Site.RegularPages "Type" "ne" "pages") -}}
    {{ $contenu := (lower .Content ) }}
    {{ range .Site.Data.ponctuations }}
        {{ $contenu = replace $contenu . " " }}
    {{ end }}
    {{ $contenu = replaceRE "(<sup.*sup>)" "" $contenu }}
    {{ $contenu = replaceRE "\n" "" ($contenu | plainify) }}
    {{ $contenu := split $contenu " " | complement .Site.Data.stopwords | uniq }}
    {{- $.Scratch.Add "index" (dict "title" ( .Title | markdownify) "section" ( (site.GetPage .Section ).Title ) "permalink" .Permalink "content" $contenu ) -}}
{{- end -}}
{{- $.Scratch.Get "index" | jsonify -}}